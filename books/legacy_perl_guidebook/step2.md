---
title: "序章: 賢者と歴史に学ぶ"
---
彼女(Perlと読む)に向き合うにはまず、歴史と向き合う覚悟を決めなければならない。
Webの界隈での3年は歴史における1世紀に相当する。(ソース無し)

僕は無意識に、Google先生に質問したとき、古い情報を削ぎ落として見てしまう。
が、よくよく思い返してほしい。

我々の戦場は西暦何年だ？
2021年？ もちろん違う。
2019年？ ちがうね。平成ではあるけどさ。
2015年？ これもちがう。このときには既にPerlはオワコンとか書いた「はてブ」でエンジニアがわちゃわちゃしていた。

答えは2010年前後だ。我々の戦場は今から10年以上、前の世界になる。
手元のPerlのバージョンを確認してくれ。`5.20`より上だった人は仲間じゃない。帰ってくれ。

僕は`5.12`だ。
今、必死こいてシステムを改修している。それでようやく`5.16`になる。
こいつらは2010,2012年リリースのPerlだ。

おおよそ、この令和の時代にもなって現存しているレガシーPerlってやつは、偉大なシステムであることが多い。
常人にはとても理解し難い魔法がそこには描かれていて、一度動き出すとカネになるんだ。
だから現存する。メンテしないといけない。でももう、誰にもわからないから成長を止めて、延命治療に移っているわけ。

そう、成長を止めているのだ。時代もそこにおいてきている。
例えば、最新の`5.34 (2021/5)`では`try-catch`構文が組み込まれた、なんてリリースノートに文字が踊っている。
いや、むしろ最近まで無かったことが驚きだ。我々の彼女はちょっと流行に疎いらしいことを頭の片隅に置いておこう。

ともかく、Perlの本質を知るには賢者と歴史から読み取るしか無い。
イマドキの言語思想は一旦そのへんに捨ててしまえ。

# この章の要点
- 彼女の生みの親の思想を読み取り、多数派プログラミング言語との差分を知る
- 彼女が嫌われてきた歴史から、何が問題視されているのかを知る

# Perlの特性について
あなたの知っている言語と、Perlの違いがどこにあるのか、なぜこんなにもPerlを難しく感じるのか、さっと答えが出るだろうか。
僕はきちんと調べるまで、このモヤッとした部分を言葉にできなかった。

単刀直入にいって、Perlは他の言語と期待される役割が違っているということに気づくと、だからこうなっちまっているのか、と腑に落ちる部分がある。

## LarryWallがPerlを作った理由
LarryWallといえば、彼女のお父さんなわけだが、「プログラマの三大美徳」でも知られる偉人である。
彼がPerlを作った理由は、C言語などよりも簡単に、強力なunixコマンド(grep,sed,awk...)と同様のことができる言語がその時代になかったから、というところに端を発している。
三大美徳にあるように、怠惰で短気だったLarryは、より簡単に目的を達成するために、Perlという言語に多くのショートハンドや糖衣を盛り込みに盛り込んでいる。たしかにC言語よりも短く、複雑なスクリプトをかけることに間違いはない。

Perlの思想には[VHLL](https://en.wikipedia.org/wiki/Very_high-level_programming_language)という昔流行った言葉が実に適している。短い行で多くのことを為せるという価値は、たしかにその時代には一斉を風靡したものであっただろう。

ここに、Perlの複雑さを読み取るヒントがある。

:::message
「Perlは簡単に使えるが、簡単には学べない」
- Perlは実装者がより簡単にコードを書くための機能をふんだんに盛り込んでいる
- ゆえに、それを使いこなせる人だけが意味を理解できる。初期の学習コストが高い
:::

良い例があるので、「初めてのPerl 第7版」の5-6Pより引用する。
次のコードをあなたは理解できるだろうか。
```perl:sample.pl
while(<>) {
    chomp;
    print join("\t", (split /:/)[0, 2, 1, 5] ), "\n";
}
```

これを実行すると、このような動きをする。
(入力=>出力=>入力=>出力と並んでいる)
```
0:1:2:3:4:5:6:7:8:9
0       2       1       5
9:8:7:6:5:4:3:2:1:0
9       7       8       4
```

このたかだが3行程度のプログラムを読むにも、彼女は膨大な前提知識を要求しているのだ。
- 1行目
  - ダイヤモンド演算子 `<>`
    - 標準入力とコマンドライン引数からの1行ずつ読み込み
    - whileにおいて単独使用した場合は`デフォルト変数/特殊変数`に結果を入れる
  - デフォルト変数
    - `$_`と表す。Perlの提供するいくらかの機能では、このデフォルト変数に結果を暗黙的に打ち込んだり、読み込んだりすることができる。初見殺しである。
- 2行目
  - chomp。対象文字列の末尾の改行文字を削除するだけの関数である。
    - ちなみに、引数を与えない場合はデフォルト変数に対して破壊的に作用する。そういうとこやぞ。
- 3行目
  - splitで`:`で入力文字列を分割して、その配列の中身を参照している。え？入力文字列ってどこにあるんだって？`デフォルト変数`に決まってるでしょ。
    - Perlの配列に対して、indexを複数与えると列を並び替えた結果を返してくる。
    - 上記の結果を"\t"でjoinし、printしている。
    - printに対してカンマ演算子を用いると、文字列を結合して表示する。(似たものにドット演算子があり、微妙に役割が違う)

このスクリプトはまさにVHLLだ。こんなにも短いのに、これだけの機能を実現できる。
そこらの最新の言語を用いたとして、ここまで単調にかける物は少ない。

近代の言語は、一つ学べば他の言語もある程度読めてしまうのが常識だ。
しかし、ことPerlに至ってはその常識が通用しない。わかっていたことだが、改めてここを再認識しなければならない。

## 迫害の歴史から学ぶ
彼女はとてもとても嫌われてきた。それは我々もよく知っていることだろう。
裏を返せば、嫌われてきたその理由に対するカウンターを、我々自身が用意できれば問題ないはず。
誰かを説得するための理由を用意できる気はしないが、我々自身が努力する分には問題ない。それ以外に選択肢など無いのだし。

### 年表
|西暦|タイトル|被ドメインスコア|
| ---- | ---- | ---- |
|2013-3|[perl - 「は衰退しました」という人々の共通点](https://blogos.com/article/57651/)|???|
|2013-3|[なぜ国内でPerlが急速に萎んだのか](https://anond.hatelabo.jp/20130307004741)|6,363|
|2013-12|[Perlは終焉した言語か](https://anopara.net/2013/12/10/perl%E3%81%AF%E7%B5%82%E7%84%89%E3%81%97%E3%81%9F%E8%A8%80%E8%AA%9E%E3%81%8B/)|155|
|2014-2|[Perlは終わった使いにくい言語である件について](https://computer-technology.hateblo.jp/entry/20140218/p1)|132|

それぞれを読んでみて、Perlはオワコン派とそれに対するカウンターを見比べてみることにする

#### 意見
- テキスト処理とShellのワンライナーだけには役に立つ（それ以外の役に立たない）
    - ちょっとシェルスクリプトでは物足りない程度の高度な処理をしたいときにPerlで書くくらい
    - => 著名なコマンドの実装がPerlであることは往々にしてあるわけで、オワコンとは言わんよね
- もともとweb向けの言語でもなければオブジェクト指向言語でもないのでつぎはぎである
    - (この辺に関するカウンターは見当たらなかった。強いて言うなら、組み込みのオブジェクト指向サポートではなく、Mooとかいう外部ライブラリはもっとスマートにやってくれるとか)
- 言語仕様が膨大で学習コストが高い
    - 学べ、という意見が強い。道具のせいにするな、という感じ。
- 使いこなしたところで、それは誰にも読めないのでメンテできない
    - 同上
- PythonやRubyと守備範囲が被っている。ここでわざわざPerlを選択肢に出す必要がない
    - これはwebの文脈に限っている気がしており、テキスト処理についてはPerlに軍配が上がるんじゃなかろうか。
- 数学、機械学習につかえるライブラリがPerlにはない
    - えんじにあって新しいもの、好きよね。(2013年前後当時なんで、新しいものだったのだろう)

Perlで残っているシステムのうち、CGIというのはそこまで多くないのではないか、と思っている。
Webだけで言うならそのI/Fとやりたいことはある程度明確で、リプレースがしやすい。

Perlがいまなお残置され、活躍しているのはやっぱりテキスト処理を中心としたデータをごちゃごちゃやっているバックエンドシステムだと僕は思っている。
実際、僕の観測範囲ではそうだし、手元にあるこいつも、そういうものだからだ。

それを前提に、意見を抜き出してみると、反対派の言い分はこれに集約される。
- 学習コストが高い
- テキスト処理、シェルスクリプト周り以外で使うな

ああ、知ってた。そうだよね〜〜〜。

# まとめ
- Perlがロジックを覆い隠しているショートカット、糖衣構文、デフォルト変数を学ぶべき
- テキスト処理・Shellまわりで使われているPerlの難しさとは向き合う以外に解決方法はない

時代のせいなのか、Perlの使われている領域のせいなのか、Perlについて色々漁っているととにかく設計論の話がない。
どうやればきれいに設計できるんだと言う話が、見当たらない。
これを読んだあなた。どうか見かけたら教えてください。それだけが私の望みです。
