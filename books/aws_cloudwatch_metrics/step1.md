---
title: "この本で対象とする「監視」について"
free: true
---
# 何が書かれているか
この本に書いてある内容は、メトリクスをうまく使って普段から監視を行っている人には当たり前のことしか書いていません。
また、名著「[入門監視](https://amzn.to/3C8m4Sn)」の内容の1割もカバーできていませんので、この本を手にとって、もしもっと監視のことが知りたい！ となれば、入門監視で再入門していただければと思います。

さて、この本が取り扱うのは「アプリケーションログ監視」です。  
AWSは標準でCPUやメモリなどのメトリクスを提供してくれていますが、アプリケーションやミドルウェアが発するログについては自分で取り扱いを決めなければなりません。

これらの操作はオンプレミス環境にはない独特な操作・知識であるため、多少の学習コストがかかってしまいます。

本書では、基礎的なログとメトリクスの話をしたあとに、Railsを題材にかんたんなログ設計の話をします。  
最終的に、そのアプリケーションをECS Fargateにデプロイし、CloudWatch、Athenaを使ったログの集積、解析について学びます。

具体的には、
- アプリケーションログをシステムから解釈可能な形に変更する
- ログによって保存先や名前を変える(ログのルーティング)
- 蓄積したログを「統計」して可視化する
- Warn/Errorではなくエラーコードを付与してロギングする
- アプリケーションログ中の値を使ってメトリクスを作成する
- カスタムメトリクスをつかってアラートをあげる

などを体験します。

## 使用技術
私自身は普段、PrometheusやTelegrafといったOSSを使った監視に関わっていますが、この本ではもっと手軽に扱えるAWS CloudWatchについて取り上げます。
具体的にはゴールに記載した画像を参照してみてください。

ECSから発生したログをFirelensを使ってログルーティングし、監視したり統計解析したりできる環境を目指します。

アプリケーションは、日本のベンチャーでよく利用されるRailsを利用し、**費用を最低限に抑える**ことを念頭にログ設計を行っていきます。

## ゴール
![](/images/metrics/metric-sample.jpg)

## サンプルコード
https://github.com/ange-k/metrics-sample
